- name: Get IPs
  hosts: localhost
  gather_facts: no
  tasks:
    - name: Collect Facts
      cisco.cml.cml_lab_facts:
        host: "{{ cml_host }}"
        user: "{{ cml_username }}"
        password: "{{ cml_password }}"
        lab: "{{ cml_lab }}"
      register: result
    - debug:
        msg: "NSO IP = {{ result.cml_facts.nodes.nso1.ansible_host }}"
    - copy:
        content: "NSO_HOST={{ result.cml_facts.nodes.nso1.ansible_host }}"
        dest: "../nso_host.txt"
    - copy:
        content: "NX1_HOST={{ result.cml_facts.nodes.nx1.ansible_host }}"
        dest: "../nx1_host.txt"
    - copy:
        content: "XE1_HOST={{ result.cml_facts.nodes.xe1.ansible_host }}"
        dest: "../xe1_host.txt"
    - copy:
        content: "XESWITCH1_HOST={{ result.cml_facts.nodes.xeswitch1.ansible_host }}"
        dest: "../xeswitch1_host.txt"
    - copy:
        content: "XR1_HOST={{ result.cml_facts.nodes.xr1.ansible_host }}"
        dest: "../xr1_host.txt"
